<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Intraclass Correlation Coefficient (ICC) — icc • performance</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Intraclass Correlation Coefficient (ICC) — icc" />
<meta property="og:description" content="This function calculates the intraclass-correlation coefficient (ICC) -
sometimes also called variance partition coefficient (VPC) - for mixed
effects models. The ICC can be calculated for all models supported by
insight::get_variance(). For models fitted with the
brms-package, icc() might fail due to the large variety of
models and families supported by the brms-package. In such cases, an
alternative to the ICC is the variance_decomposition(), which is based
on the posterior predictive distribution (see 'Details')." />
<meta property="og:image" content="https://easystats.github.io/performance/logo.png" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">performance</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Features</a>
</li>
<li>
  <a href="../articles/compare.html">Compare, Test and Select Models</a>
</li>
<li>
  <a href="../articles/r2.html">Explained Variance (R-Squared)</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/easystats/performance/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Intraclass Correlation Coefficient (ICC)</h1>
    <small class="dont-index">Source: <a href='https://github.com/easystats/performance/blob/master/R/icc.R'><code>R/icc.R</code></a></small>
    <div class="hidden name"><code>icc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function calculates the intraclass-correlation coefficient (ICC) -
sometimes also called <em>variance partition coefficient</em> (VPC) - for mixed
effects models. The ICC can be calculated for all models supported by
<code><a href='https://easystats.github.io/insight/reference/get_variance.html'>insight::get_variance()</a></code>. For models fitted with the
<strong>brms</strong>-package, <code>icc()</code> might fail due to the large variety of
models and families supported by the <strong>brms</strong>-package. In such cases, an
alternative to the ICC is the <code>variance_decomposition()</code>, which is based
on the posterior predictive distribution (see 'Details').</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>icc</span><span class='op'>(</span><span class='va'>model</span>, by_group <span class='op'>=</span> <span class='cn'>FALSE</span>, tolerance <span class='op'>=</span> <span class='fl'>1e-05</span><span class='op'>)</span>

<span class='fu'>variance_decomposition</span><span class='op'>(</span><span class='va'>model</span>, re_formula <span class='op'>=</span> <span class='cn'>NULL</span>, robust <span class='op'>=</span> <span class='cn'>TRUE</span>, ci <span class='op'>=</span> <span class='fl'>0.95</span>, <span class='va'>...</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>A (Bayesian) mixed effects model.</p></td>
    </tr>
    <tr>
      <th>by_group</th>
      <td><p>Logical, if <code>TRUE</code>, <code>icc()</code> returns the variance
components for each random-effects level (if there are multiple levels).
See 'Details'.</p></td>
    </tr>
    <tr>
      <th>tolerance</th>
      <td><p>Tolerance for singularity check of random effects, to decide
whether to compute random effect variances or not. Indicates up to which
value the convergence result is accepted. The larger tolerance is, the
stricter the test will be. See <code><a href='check_singularity.html'>check_singularity()</a></code>.</p></td>
    </tr>
    <tr>
      <th>re_formula</th>
      <td><p>Formula containing group-level effects to be considered in
the prediction. If <code>NULL</code> (default), include all group-level effects.
Else, for instance for nested models, name a specific group-level effect
to calculate the variance decomposition for this group-level. See 'Details'
and <code><a href='https://rdrr.io/pkg/brms/man/posterior_predict.brmsfit.html'>?brms::posterior_predict</a></code>.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>Logical, if <code>TRUE</code>, the median instead of mean is used to
calculate the central tendency of the variances.</p></td>
    </tr>
    <tr>
      <th>ci</th>
      <td><p>Credible interval level.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed down to <code><a href='https://rdrr.io/pkg/brms/man/posterior_predict.brmsfit.html'>brms::posterior_predict()</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with two values, the adjusted and conditional ICC. For
<code>variance_decomposition()</code>, a list with two values, the decomposed
ICC as well as the credible intervals for this ICC.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='interpretation'><a class='anchor' aria-hidden='true' href='#interpretation'></a>Interpretation</h3>
<p>The ICC can be interpreted as &#8220;the proportion of the variance
 explained by the grouping structure in the population&#8221;. The grouping
 structure entails that measurements are organized into groups (e.g., test
 scores in a school can be grouped by classroom if there are multiple
 classrooms and each classroom was administered the same test) and ICC indexes
 how strongly measurements in the same group resemble each other. This index
 goes from 0, if the grouping conveys no information, to 1, if all
 observations in a group are identical (Gelman \&amp; Hill, 2007, p. 258). In
 other word, the ICC &#8220;can also be interpreted as the expected
 correlation between two randomly drawn units that are in the same group&#8221;
 <cite>(Hox 2010: 15)</cite>, although this definition might not apply to mixed
 models with more complex random effects structures.</p><p></p><h3 class='hasAnchor' id='calculation'><a class='anchor' aria-hidden='true' href='#calculation'></a>Calculation</h3>
<p>The ICC is calculated by dividing the random effect variance,
 &sigma;<sup>2</sup><sub>i</sub>, by
 the total variance, i.e. the sum of the random effect variance and the
 residual variance, &sigma;<sup>2</sup><sub>&epsilon;</sub>.</p><p></p><h3 class='hasAnchor' id='adjusted-and-conditional-icc'><a class='anchor' aria-hidden='true' href='#adjusted-and-conditional-icc'></a>Adjusted and conditional ICC</h3>
<p><code>icc()</code> calculates an adjusted and conditional ICC, which both take all
 sources of uncertainty (i.e. of <em>all random effects</em>) into account.
 While the <em>adjusted ICC</em> only relates to the random effects, the
 <em>conditional ICC</em> also takes the fixed effects variances into account
 (see <cite>Nakagawa et al. 2017</cite>). Typically, the <em>adjusted</em> ICC is of
 interest when the analysis of random effects is of interest. <code>icc()</code>
 returns a meaningful ICC also for more complex random effects structures,
 like models with random slopes or nested design (more than two levels) and
 is applicable for models with other distributions than Gaussian. For more
 details on the computation of the variances, see
 <code><a href='https://easystats.github.io/insight/reference/get_variance.html'>?insight::get_variance</a></code>.</p><p></p><h3 class='hasAnchor' id='icc-for-unconditional-and-conditional-models'><a class='anchor' aria-hidden='true' href='#icc-for-unconditional-and-conditional-models'></a>ICC for unconditional and conditional models</h3>
<p>Usually, the ICC is calculated for the null model ("unconditional model").
 However, according to <cite>Raudenbush and Bryk (2002)</cite> or
 <cite>Rabe-Hesketh and Skrondal (2012)</cite> it is also feasible to compute the
 ICC for full models with covariates ("conditional models") and compare how
 much, e.g., a level-2 variable explains the portion of variation in the
 grouping structure (random intercept).</p><p></p><h3 class='hasAnchor' id='icc-for-specific-group-levels'><a class='anchor' aria-hidden='true' href='#icc-for-specific-group-levels'></a>ICC for specific group-levels</h3>
<p>The proportion of variance for specific levels related to the overall model
 can be computed by setting <code>by_group = TRUE</code>. The reported ICC is
 the variance for each (random effect) group compared to the total
 variance of the model. For mixed models with a simple random intercept,
 this is identical to the classical (adjusted) ICC.</p><p></p><h3 class='hasAnchor' id='variance-decomposition-for-brms-models'><a class='anchor' aria-hidden='true' href='#variance-decomposition-for-brms-models'></a>Variance decomposition for brms-models</h3>
<p>If <code>model</code> is of class <code>brmsfit</code>, <code>icc()</code> might fail due to
 the large variety of models and families supported by the <strong>brms</strong>
 package. In such cases, <code>variance_decomposition()</code> is an alternative
 ICC measure. The function calculates a variance decomposition based on the
 posterior predictive distribution. In this case, first, the draws from the
 posterior predictive distribution <em>not conditioned</em> on group-level
 terms (<code>posterior_predict(..., re_formula = NA)</code>) are calculated as
 well as draws from this distribution <em>conditioned</em> on <em>all random
 effects</em> (by default, unless specified else in <code>re_formula</code>) are taken.
 Then, second, the variances for each of these draws are calculated. The
 "ICC" is then the ratio between these two variances. This is the recommended
 way to analyse random-effect-variances for non-Gaussian models. It is then
 possible to compare variances across models, also by specifying different
 group-level terms via the <code>re_formula</code>-argument.
 <br /> <br />
 Sometimes, when the variance of the posterior predictive distribution is
 very large, the variance ratio in the output makes no sense, e.g. because
 it is negative. In such cases, it might help to use <code>robust = TRUE</code>.</p>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p>Hox, J. J. (2010). Multilevel analysis: techniques and applications
 (2nd ed). New York: Routledge.</p></li>
<li><p>Nakagawa, S., Johnson, P. C. D., &amp; Schielzeth, H. (2017). The
 coefficient of determination R2 and intra-class correlation coefficient from
 generalized linear mixed-effects models revisited and expanded. Journal of
 The Royal Society Interface, 14(134), 20170213. doi: <a href='https://doi.org/10.1098/rsif.2017.0213'>10.1098/rsif.2017.0213</a></p></li>
<li><p>Rabe-Hesketh, S., &amp; Skrondal, A. (2012). Multilevel and longitudinal
 modeling using Stata (3rd ed). College Station, Tex: Stata Press
 Publication.</p></li>
<li><p>Raudenbush, S. W., &amp; Bryk, A. S. (2002). Hierarchical linear models:
 applications and data analysis methods (2nd ed). Thousand Oaks: Sage
 Publications.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/lme4/lme4/'>"lme4"</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Length</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>Species</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='fu'>icc</span><span class='op'>(</span><span class='va'>model</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #0000BB;'># Intraclass Correlation Coefficient</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      Adjusted ICC: 0.910</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   Conditional ICC: 0.311</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># ICC for specific group-levels</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/lme4/lme4/'>"lme4"</a></span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>sleepstudy</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>12345</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='va'>sleepstudy</span><span class='op'>$</span><span class='va'>grp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, size <span class='op'>=</span> <span class='fl'>180</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='va'>sleepstudy</span><span class='op'>$</span><span class='va'>subgrp</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span></span>
<span class='r-in'>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>    <span class='va'>filter_group</span> <span class='op'>&lt;-</span> <span class='va'>sleepstudy</span><span class='op'>$</span><span class='va'>grp</span> <span class='op'>==</span> <span class='va'>i</span></span>
<span class='r-in'>    <span class='va'>sleepstudy</span><span class='op'>$</span><span class='va'>subgrp</span><span class='op'>[</span><span class='va'>filter_group</span><span class='op'>]</span> <span class='op'>&lt;-</span></span>
<span class='r-in'>      <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>30</span>, size <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>filter_group</span><span class='op'>)</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>}</span></span>
<span class='r-in'>  <span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span><span class='op'>(</span></span>
<span class='r-in'>    <span class='va'>Reaction</span> <span class='op'>~</span> <span class='va'>Days</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>grp</span> <span class='op'>/</span> <span class='va'>subgrp</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>Subject</span><span class='op'>)</span>,</span>
<span class='r-in'>    data <span class='op'>=</span> <span class='va'>sleepstudy</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-in'>  <span class='fu'>icc</span><span class='op'>(</span><span class='va'>model</span>, by_group <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> <span style='color: #0000BB;'># ICC by Group</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Group      |   ICC</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ------------------</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> subgrp:grp | 0.017</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Subject    | 0.589</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> grp        | 0.001</span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://github.com/mattansb" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, Philip Waggoner, <a href="https://wiernik.org/" class="external-link">Brenton M. Wiernik</a>.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


