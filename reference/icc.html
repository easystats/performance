<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function calculates the intraclass-correlation coefficient (ICC) -
sometimes also called variance partition coefficient (VPC) or
repeatability - for mixed effects models. The ICC can be calculated for all
models supported by insight::get_variance(). For models fitted with the
brms-package, icc() might fail due to the large variety of
models and families supported by the brms-package. In such cases, an
alternative to the ICC is the variance_decomposition(), which is based
on the posterior predictive distribution (see 'Details')."><title>Intraclass Correlation Coefficient (ICC) — icc • performance</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.6/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.6/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.6/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Intraclass Correlation Coefficient (ICC) — icc"><meta property="og:description" content="This function calculates the intraclass-correlation coefficient (ICC) -
sometimes also called variance partition coefficient (VPC) or
repeatability - for mixed effects models. The ICC can be calculated for all
models supported by insight::get_variance(). For models fitted with the
brms-package, icc() might fail due to the large variety of
models and families supported by the brms-package. In such cases, an
alternative to the ICC is the variance_decomposition(), which is based
on the posterior predictive distribution (see 'Details')."><meta property="og:image" content="https://easystats.github.io/performance/reference/figures/card.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@easystats4u"><meta name="twitter:site" content="@easystats4u"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">performance</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html" aria-label="Reference">
    <span class="fa fa fa fa-file-code"></span>
     
    Reference
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html" aria-label="Articles">
    <span class="fa fa fa fa-book-reader"></span>
     
    Articles
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html" aria-label="News">
    <span class="fa fa fa fa-newspaper"></span>
     
    News
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--easystats" aria-label="easystats">
    <span class="fab fa fab fa-r-project"></span>
     
    easystats
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--easystats">
    <a class="external-link dropdown-item" href="https://easystats.github.io/bayestestR/">bayestestR</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/correlation/">correlation</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/datawizard/">datawizard</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/easystats/">easystats</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/effectsize/">effectsize</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/insight/">insight</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/modelbased/">modelbased</a>
    <a class="dropdown-item" href="https://easystats.github.io/performance/">performance</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/parameters/">parameters</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/report/">report</a>
    <a class="external-link dropdown-item" href="https://easystats.github.io/see/">see</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="http://twitter.com/easystats4u" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/easystats/performance/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Intraclass Correlation Coefficient (ICC)</h1>
      <small class="dont-index">Source: <a href="https://github.com/easystats/performance/blob/HEAD/R/icc.R" class="external-link"><code>R/icc.R</code></a></small>
      <div class="d-none name"><code>icc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates the intraclass-correlation coefficient (ICC) -
sometimes also called <em>variance partition coefficient</em> (VPC) or
<em>repeatability</em> - for mixed effects models. The ICC can be calculated for all
models supported by <code><a href="https://easystats.github.io/insight/reference/get_variance.html" class="external-link">insight::get_variance()</a></code>. For models fitted with the
<strong>brms</strong>-package, <code>icc()</code> might fail due to the large variety of
models and families supported by the <strong>brms</strong>-package. In such cases, an
alternative to the ICC is the <code>variance_decomposition()</code>, which is based
on the posterior predictive distribution (see 'Details').</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">icc</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  by_group <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  ci <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  ci_method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">variance_decomposition</span><span class="op">(</span><span class="va">model</span>, re_formula <span class="op">=</span> <span class="cn">NULL</span>, robust <span class="op">=</span> <span class="cn">TRUE</span>, ci <span class="op">=</span> <span class="fl">0.95</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>model</dt>
<dd><p>A (Bayesian) mixed effects model.</p></dd>


<dt>by_group</dt>
<dd><p>Logical, if <code>TRUE</code>, <code>icc()</code> returns the variance
components for each random-effects level (if there are multiple levels).
See 'Details'.</p></dd>


<dt>tolerance</dt>
<dd><p>Tolerance for singularity check of random effects, to decide
whether to compute random effect variances or not. Indicates up to which
value the convergence result is accepted. The larger tolerance is, the
stricter the test will be. See <code><a href="check_singularity.html">performance::check_singularity()</a></code>.</p></dd>


<dt>ci</dt>
<dd><p>Confidence resp. credible interval level. For <code>icc()</code> and <code><a href="r2.html">r2()</a></code>,
confidence intervals are based on bootstrapped samples from the ICC resp.
R2 value. See <code>iterations</code>.</p></dd>


<dt>iterations</dt>
<dd><p>Number of bootstrap-replicates when computing confidence
intervals for the ICC or R2.</p></dd>


<dt>ci_method</dt>
<dd><p>Character string, indicating the bootstrap-method. Should
be <code>NULL</code> (default), in which case <code><a href="https://rdrr.io/pkg/lme4/man/bootMer.html" class="external-link">lme4::bootMer()</a></code> is used for
bootstrapped confidence intervals. However, if bootstrapped intervals cannot
be calculated this was, try <code>ci_method = "boot"</code>, which falls back to
<code><a href="https://rdrr.io/pkg/boot/man/boot.html" class="external-link">boot::boot()</a></code>. This may successfully return bootstrapped confidence intervals,
but bootstrapped samples may not be appropriate for the multilevel structure
of the model. There is also an option <code>ci_method = "analytical"</code>, which tries
to calculate analytical confidence assuming a chi-squared distribution.
However, these intervals are rather inaccurate and often too narrow. It is
recommended to calculate bootstrapped confidence intervals for mixed models.</p></dd>


<dt>verbose</dt>
<dd><p>Toggle warnings and messages.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed down to <code><a href="https://mc-stan.org/rstantools/reference/posterior_predict.html" class="external-link">brms::posterior_predict()</a></code>.</p></dd>


<dt>re_formula</dt>
<dd><p>Formula containing group-level effects to be considered in
the prediction. If <code>NULL</code> (default), include all group-level effects.
Else, for instance for nested models, name a specific group-level effect
to calculate the variance decomposition for this group-level. See 'Details'
and <code><a href="https://mc-stan.org/rstantools/reference/posterior_predict.html" class="external-link">?brms::posterior_predict</a></code>.</p></dd>


<dt>robust</dt>
<dd><p>Logical, if <code>TRUE</code>, the median instead of mean is used to
calculate the central tendency of the variances.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with two values, the adjusted ICC and the unadjusted ICC. For
<code>variance_decomposition()</code>, a list with two values, the decomposed
ICC as well as the credible intervals for this ICC.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    
<div class="section">
<h3 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a></h3>


<p>The ICC can be interpreted as "the proportion of the variance explained by
the grouping structure in the population". The grouping structure entails
that measurements are organized into groups (e.g., test scores in a school
can be grouped by classroom if there are multiple classrooms and each
classroom was administered the same test) and ICC indexes how strongly
measurements in the same group resemble each other. This index goes from 0,
if the grouping conveys no information, to 1, if all observations in a group
are identical (<em>Gelman and Hill, 2007, p. 258</em>). In other word, the ICC -
sometimes conceptualized as the measurement repeatability - "can also be
interpreted as the expected correlation between two randomly drawn units
that are in the same group" <em>(Hox 2010: 15)</em>, although this definition might
not apply to mixed models with more complex random effects structures. The
ICC can help determine whether a mixed model is even necessary: an ICC of
zero (or very close to zero) means the observations within clusters are no
more similar than observations from different clusters, and setting it as a
random factor might not be necessary.</p>
</div>

<div class="section">
<h3 id="difference-with-r-">Difference with R2<a class="anchor" aria-label="anchor" href="#difference-with-r-"></a></h3>


<p>The coefficient of determination R2 (that can be computed with <code><a href="r2.html">r2()</a></code>)
quantifies the proportion of variance explained by a statistical model, but
its definition in mixed model is complex (hence, different methods to compute
a proxy exist). ICC is related to R2 because they are both ratios of
variance components. More precisely, R2 is the proportion of the explained
variance (of the full model), while the ICC is the proportion of explained
variance that can be attributed to the random effects. In simple cases, the
ICC corresponds to the difference between the <em>conditional R2</em> and the
<em>marginal R2</em> (see <code><a href="r2_nakagawa.html">r2_nakagawa()</a></code>).</p>
</div>

<div class="section">
<h3 id="calculation">Calculation<a class="anchor" aria-label="anchor" href="#calculation"></a></h3>


<p>The ICC is calculated by dividing the random effect variance,
σ<sup>2</sup><sub>i</sub>, by
the total variance, i.e. the sum of the random effect variance and the
residual variance, σ<sup>2</sup><sub>ε</sub>.</p>
</div>

<div class="section">
<h3 id="adjusted-and-unadjusted-icc">Adjusted and unadjusted ICC<a class="anchor" aria-label="anchor" href="#adjusted-and-unadjusted-icc"></a></h3>


<p><code>icc()</code> calculates an adjusted and an unadjusted ICC, which both take all
sources of uncertainty (i.e. of <em>all random effects</em>) into account. While
the <em>adjusted ICC</em> only relates to the random effects, the <em>unadjusted ICC</em>
also takes the fixed effects variances into account, more precisely, the
fixed effects variance is added to the denominator of the formula to
calculate the ICC (see <em>Nakagawa et al. 2017</em>). Typically, the <em>adjusted</em>
ICC is of interest when the analysis of random effects is of interest.
<code>icc()</code> returns a meaningful ICC also for more complex random effects
structures, like models with random slopes or nested design (more than two
levels) and is applicable for models with other distributions than Gaussian.
For more details on the computation of the variances, see
<code><a href="https://easystats.github.io/insight/reference/get_variance.html" class="external-link">?insight::get_variance</a></code>.</p>
</div>

<div class="section">
<h3 id="icc-for-unconditional-and-conditional-models">ICC for unconditional and conditional models<a class="anchor" aria-label="anchor" href="#icc-for-unconditional-and-conditional-models"></a></h3>


<p>Usually, the ICC is calculated for the null model ("unconditional model").
However, according to <em>Raudenbush and Bryk (2002)</em> or
<em>Rabe-Hesketh and Skrondal (2012)</em> it is also feasible to compute the
ICC for full models with covariates ("conditional models") and compare how
much, e.g., a level-2 variable explains the portion of variation in the
grouping structure (random intercept).</p>
</div>

<div class="section">
<h3 id="icc-for-specific-group-levels">ICC for specific group-levels<a class="anchor" aria-label="anchor" href="#icc-for-specific-group-levels"></a></h3>


<p>The proportion of variance for specific levels related to the overall model
can be computed by setting <code>by_group = TRUE</code>. The reported ICC is
the variance for each (random effect) group compared to the total
variance of the model. For mixed models with a simple random intercept,
this is identical to the classical (adjusted) ICC.</p>
</div>

<div class="section">
<h3 id="variance-decomposition-for-brms-models">Variance decomposition for brms-models<a class="anchor" aria-label="anchor" href="#variance-decomposition-for-brms-models"></a></h3>


<p>If <code>model</code> is of class <code>brmsfit</code>, <code>icc()</code> might fail due to the large
variety of models and families supported by the <strong>brms</strong> package. In such
cases, <code>variance_decomposition()</code> is an alternative ICC measure. The function
calculates a variance decomposition based on the posterior predictive
distribution. In this case, first, the draws from the posterior predictive
distribution <em>not conditioned</em> on group-level terms
(<code>posterior_predict(..., re_formula = NA)</code>) are calculated as well as draws
from this distribution <em>conditioned</em> on <em>all random effects</em> (by default,
unless specified else in <code>re_formula</code>) are taken. Then, second, the variances
for each of these draws are calculated. The "ICC" is then the ratio between
these two variances. This is the recommended way to analyse
random-effect-variances for non-Gaussian models. It is then possible to
compare variances across models, also by specifying different group-level
terms via the <code>re_formula</code>-argument.</p>
<p>Sometimes, when the variance of the posterior predictive distribution is
very large, the variance ratio in the output makes no sense, e.g. because
it is negative. In such cases, it might help to use <code>robust = TRUE</code>.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p>Hox, J. J. (2010). Multilevel analysis: techniques and applications
(2nd ed). New York: Routledge.</p></li>
<li><p>Nakagawa, S., Johnson, P. C. D., and Schielzeth, H. (2017). The
coefficient of determination R2 and intra-class correlation coefficient
from generalized linear mixed-effects models revisited and expanded.
Journal of The Royal Society Interface, 14(134), 20170213.</p></li>
<li><p>Rabe-Hesketh, S., and Skrondal, A. (2012). Multilevel and longitudinal
modeling using Stata (3rd ed). College Station, Tex: Stata Press
Publication.</p></li>
<li><p>Raudenbush, S. W., and Bryk, A. S. (2002). Hierarchical linear models:
applications and data analysis methods (2nd ed). Thousand Oaks: Sage
Publications.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/" class="external-link">"lme4"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Petal.Length</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Species</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">icc</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;"># Intraclass Correlation Coefficient</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Adjusted ICC: 0.910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Unadjusted ICC: 0.311</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ICC for specific group-levels</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/" class="external-link">"lme4"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sleepstudy</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sleepstudy</span><span class="op">$</span><span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, size <span class="op">=</span> <span class="fl">180</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sleepstudy</span><span class="op">$</span><span class="va">subgrp</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">filter_group</span> <span class="op">&lt;-</span> <span class="va">sleepstudy</span><span class="op">$</span><span class="va">grp</span> <span class="op">==</span> <span class="va">i</span></span></span>
<span class="r-in"><span>    <span class="va">sleepstudy</span><span class="op">$</span><span class="va">subgrp</span><span class="op">[</span><span class="va">filter_group</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">filter_group</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">grp</span> <span class="op">/</span> <span class="va">subgrp</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="va">sleepstudy</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">icc</span><span class="op">(</span><span class="va">model</span>, by_group <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;"># ICC by Group</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group      |   ICC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> subgrp:grp | 0.017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Subject    | 0.589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> grp        | 0.001</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://github.com/strengejacke" class="external-link">Daniel Lüdecke</a>, <a href="https://dominiquemakowski.github.io/" class="external-link">Dominique Makowski</a>, <a href="https://home.msbstats.info/" class="external-link">Mattan S. Ben-Shachar</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>, Philip Waggoner, <a href="https://wiernik.org/" class="external-link">Brenton M. Wiernik</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

    </footer></div>

  

  

  </body></html>

